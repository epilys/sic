{% extends "base.html" %}
{% load humanize %}
{% load utils %}
{% block title %}sic{% endblock %}
{% block content %}
    <ul class="posts">
        {% for b in bookmarks %}
            {% if b.is_story %}
                {% with post=b.story %}
                    <li class="story">
                        {% spaceless %}
                            <div class="votes">
                                <div class="upvote{% if post.upvoted %} upvoted{% endif %}">
                                    {% if request.user.is_authenticated %}
                                        <form>
                                            <input type="submit" formaction="{% url_with_next 'upvote_story' post.pk request %}" formmethod="GET" value="">
                                        </form>
                                    {% endif %}
                                </div>
                                <div class="score">
                                    {{post.karma}}
                                </div>
                            </div>
                            <div class="title">
                                <a href="{{post.get_listing_url}}">{{ post.title }}</a>
                            </div>
                            <div class="links">{% if post.user.avatar %}<img class="avatar-small" src="{{post.user.avatar}}" alt="user avatar">{% endif %}{% if post.user_is_author %}authored by{% else %}via{% endif %} <a href="{{ post.user.get_absolute_url }}">{{ post.user }}</a> <time datetime="{{ post.created | date:"Y-m-d H:i:s" }}" title="{{ post.created }}"> {{ post.created|naturaltime }}</time> | flag | hide | save | archived copy | <a href="{{post.get_absolute_url}}">{{ post.comments.count }} comments</a></div>
                        {% endspaceless %}
                    </li>
                {% endwith %}
            {% else %}
                {% include "comment.html" with comment=b.comment reply_form=reply_form shallow=True %}
            {% endif %}
            <li>
                <div>
                    <p>Annotation:</p>
                    {% if b.annotation %}
                        {{ b.annotation }}
                    {% else %}
                        <p>None.</p>
                    {% endif %}
                    <a href="{% url 'edit_bookmark' b.pk %}">edit bookmark</a>
                </div>
                <div>
                    <p>Added:</p>
                    {{ b.created }}
                </div>
            </li>
        {% endfor %}
    </ul>
    <div class="pagination">
        <span class="step-links">
            {% if bookmarks.has_previous %}
                <a href="{% url 'saved_posts' %}">&laquo; first</a>
                <a href="{% url 'saved_posts_page' page_num=bookmarks.previous_page_number %}">&lt; previous</a>
            {% endif %}

            <span class="current">
                Page {{ bookmarks.number }}
            </span>

            {% if bookmarks.has_next %}
                <a href="{% url 'saved_posts_page' page_num=bookmarks.next_page_number %}">next &gt;</a>
            {% else %}
                (of {{bookmarks.number}})
            {% endif %}
        </span>
    </div>
{% endblock %}
